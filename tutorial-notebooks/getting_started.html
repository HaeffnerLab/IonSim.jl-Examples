
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="Getting started with IonSim" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://ionsim.org/tutorial-notebooks/getting_started.html" />
<meta property="og:description" content="What does IonSim do?: IonSim is built on top of QuantumOptics.jl[ KramerPOR18] and is primarily intended to simulate the following general system: A laser shining on a linear chain of trapped ions...." />
<meta property="og:image" content="https://raw.githubusercontent.com/HaeffnerLab/IonSim.jl-Examples/master/logo3_SM.png" />
<meta property="og:image:alt" content="Getting started with IonSim" />
<meta name="description" content="What does IonSim do?: IonSim is built on top of QuantumOptics.jl[ KramerPOR18] and is primarily intended to simulate the following general system: A laser shining on a linear chain of trapped ions...." />

    <title>Getting started with IonSim</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/customize.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/small-logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Installation" href="Installation.html" />
    <link rel="prev" title="Introduction" href="../intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Getting started with IonSim
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Installation.html">
   Installation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Examples
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../example-notebooks/multi-mode_interactions.html">
   Ion-laser interactions mediated by multiple vibrational modes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../example-notebooks/two_ion_vaet.html">
   Two-ion Vibrationally Assisted Energy Transport (VAET)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../example-notebooks/ramped_molmer_sorensen.html">
   Ramped Mølmer-Sørensen
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/HaeffnerLab/IonSim.jl-Examples/master?urlpath=lab/tree/webpage/tutorial-notebooks/getting_started.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/HaeffnerLab/IonSim.jl-Examples"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/HaeffnerLab/IonSim.jl-Examples/issues/new?title=Issue%20on%20page%20%2Ftutorial-notebooks/getting_started.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/HaeffnerLab/IonSim.jl-Examples/edit/master/webpage/tutorial-notebooks/getting_started.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/tutorial-notebooks/getting_started.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-does-ionsim-do">
   What does IonSim do?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-it-works">
   How it works
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-necessary-modules">
   Load necessary modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-system">
   Defining the system
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulating-basic-dynamics">
   Simulating basic dynamics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#carrier-rabi-oscillations">
     Carrier Rabi oscillations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sideband-transitions">
     Sideband Transitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-dependent-parameters">
     Time-dependent parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#noise-in-progress">
     Noise (in progress)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-more-than-a-single-ion-laser">
     Adding more than a single ion/laser
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ionsim-physicalconstants">
   IonSim.PhysicalConstants
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bibliography">
   Bibliography
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Getting started with IonSim</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-does-ionsim-do">
   What does IonSim do?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-it-works">
   How it works
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-necessary-modules">
   Load necessary modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-system">
   Defining the system
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulating-basic-dynamics">
   Simulating basic dynamics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#carrier-rabi-oscillations">
     Carrier Rabi oscillations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sideband-transitions">
     Sideband Transitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-dependent-parameters">
     Time-dependent parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#noise-in-progress">
     Noise (in progress)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-more-than-a-single-ion-laser">
     Adding more than a single ion/laser
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ionsim-physicalconstants">
   IonSim.PhysicalConstants
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bibliography">
   Bibliography
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="getting-started-with-ionsim">
<h1>Getting started with IonSim<a class="headerlink" href="#getting-started-with-ionsim" title="Permalink to this headline">#</a></h1>
<section id="what-does-ionsim-do">
<h2>What does IonSim do?<a class="headerlink" href="#what-does-ionsim-do" title="Permalink to this headline">#</a></h2>
<p>IonSim is built on top of <a class="reference external" href="https://qojulia.org/">QuantumOptics.jl</a><span id="id1">[<a class="reference internal" href="#id7" title="Sebastian Krämer, David Plankensteiner, Laurin Ostermann, and Helmut Ritsch. Quantumoptics. jl: a julia framework for simulating open quantum systems. Computer Physics Communications, 227:109–116, 2018.">KramerPOR18</a>]</span> and is primarily intended to simulate the following general system:</p>
<figure class="align-default" id="linear-chain-image">
<a class="reference internal image-reference" href="../_images/trapped_ion_system.png"><img alt="../_images/trapped_ion_system.png" src="../_images/trapped_ion_system.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">A laser shining on a linear chain of trapped ions.</span><a class="headerlink" href="#linear-chain-image" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>or similar systems with different center of mass configurations. In an appropriate rotating frame, the Hamiltonian for the system in <a class="reference internal" href="#linear-chain-image"><span class="std std-ref">Fig. 1</span></a> is given by:</p>
<div class="math notranslate nohighlight" id="equation-linear-chain-hamiltonian">
<span class="eqno">(1)<a class="headerlink" href="#equation-linear-chain-hamiltonian" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
\hat{H} = \sum_{n=1}^N \sum_{m=1}^M \sum_{j_n=1}^{J_n}
\bigg[&amp;\frac{\Omega_{nm}(t)}{2} \sum_{k_n \ne j_n}^{J_n} g(m, k_n, j_n) \hat{\sigma}_{n,k_n,j_n}e^{-i(\bar{\Delta}_{n,m,k_n,j_n}t+\phi_m(t))} e^{i\sum_{l=1}^L \eta_{nml}(t)(\hat{a}_l e^{-i\bar{\nu}_l t} + \hat{a}^{\dagger}_l e^{i\bar{\nu}_l t})} \\
+&amp; \frac{\delta\Delta_{j_n}^B(t)}{2} |j_n\rangle\langle j_n | + \sum_{l=1}^L \frac{\delta\nu_l(t)}{2} \hat{a}^{\dagger}\hat{a}
\bigg] + h.c.
\end{align}
\end{split}\]</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Variable definitions:<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text"><span class="math notranslate nohighlight">\(\pmb{\Omega_{nm} \cdot g(m, k_n, j_n)}\)</span> describes the coupling between the <span class="math notranslate nohighlight">\(m^{th}\)</span> laser and the <span class="math notranslate nohighlight">\(n^{th}\)</span> ion’s <span class="math notranslate nohighlight">\(|k_n\rangle \leftrightarrow | j_n \rangle\)</span> transition (<em><span class="math notranslate nohighlight">\(\Omega_{nm}\)</span> depends on the intensity of the laser at the ion’s position and <span class="math notranslate nohighlight">\(g\)</span> is a geometric factor that depends on the details of the laser and transition.</em>)</p></li>
<li><p class="sd-card-text"><span class="math notranslate nohighlight">\(\pmb{\hat{\sigma}_{n,k_n,j_n}} = |k_n\rangle\langle j_n|\)</span></p></li>
<li><p class="sd-card-text"><span class="math notranslate nohighlight">\(\pmb{\bar{\Delta}_{nmk_nj_n}}\)</span> is the average detuning of the m<span class="math notranslate nohighlight">\(^{th}\)</span> laser from <span class="math notranslate nohighlight">\(|k_n\rangle \leftrightarrow | j_n \rangle\)</span>.</p></li>
<li><p class="sd-card-text"><span class="math notranslate nohighlight">\(\pmb{\phi_m}\)</span> is the initial phase of the <span class="math notranslate nohighlight">\(m^{th}\)</span> laser.</p></li>
<li><p class="sd-card-text"><span class="math notranslate nohighlight">\(\pmb{\eta_{nml}}\)</span> is the Lamb-Dicke factor for the particular ion, laser, mode combination.</p></li>
<li><p class="sd-card-text"><span class="math notranslate nohighlight">\(\pmb{\hat{a}_l}\)</span> is the Boson annihilation operator the the <span class="math notranslate nohighlight">\(l^{th}\)</span> mode.</p></li>
<li><p class="sd-card-text"><span class="math notranslate nohighlight">\(\pmb{\bar{\nu}_l}\)</span> is the average vibrational frequency for the <span class="math notranslate nohighlight">\(l^{th}\)</span> mode.</p></li>
</ul>
</div>
</details><p>To enable simulation of the above system, IonSim performs two main tasks:</p>
<ol class="simple">
<li><p>Keeps track of the parameters and structure of the Hamiltonian according to user inputs</p></li>
<li><p>Given these inputs, constructs a function that efficiently returns the numerical representation of the Hamiltonian as a function of time.</p></li>
</ol>
<p>The Hamiltonian function can then be used as input to one of the various <strong>QuantumOptics.jl</strong> differential equation solvers.</p>
<p><strong>1)</strong> is accomplished with the use of Julia <a class="reference external" href="https://docs.julialang.org/en/v1/manual/types/"><code class="docutils literal notranslate"><span class="pre">structs</span></code></a>.</p>
<p>For reference, a map of these <code class="docutils literal notranslate"><span class="pre">structs</span></code> and their relationships is shown below.</p>
<figure class="align-center" id="graph">
<a class="reference internal image-reference" href="../_images/graph.png"><img alt="../_images/graph.png" src="../_images/graph.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Organization of system parameters.</span><a class="headerlink" href="#graph" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>2)</strong> is mainly handled in <a class="reference external" href="https://github.com/HaeffnerLab/IonSim.jl/blob/master/src/hamiltonians.jl">hamiltonians.jl</a>.</p>
</section>
<section id="how-it-works">
<h2>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">#</a></h2>
<p>We’ll demonstrate the basics by walking you through some simple examples.</p>
</section>
<section id="load-necessary-modules">
<h2>Load necessary modules<a class="headerlink" href="#load-necessary-modules" title="Permalink to this headline">#</a></h2>
<p>When starting a new notebook, the first thing we have to do is load in the relevant modules.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Loading modules can be slow in Julia. The same is true when running a function for the first time. This is often referred to as the <em>time-to-first-plot problem</em>, see <a class="reference external" href="https://stackoverflow.com/questions/47501844/julia-differentialequations-jl-speed">here</a> or <a class="reference external" href="https://discourse.julialang.org/t/ways-to-make-slow-sluggish-repl-interactive-development-experience-faster/25293">here</a> for more details. One workaround is to just keep notebooks running as long as possible, but you can also look into creating a sysimage with <a class="reference external" href="https://github.com/JuliaLang/PackageCompiler.jla">PackageCompiler.jl</a>.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">IonSim</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">QuantumOptics</span><span class="o">:</span><span class="w"> </span><span class="n">timeevolution</span><span class="p">,</span><span class="w"> </span><span class="n">stochastic</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Pkg</span><span class="w"></span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;StochasticDiffEq&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;DSP&quot;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>We’ll also load PyPlot (an interface to Python’s matplotlib), which we’ll need later</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="n">PyPlot</span><span class="w"></span>
<span class="k">const</span><span class="w"> </span><span class="n">plt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyPlot</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># set some plot configs</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;xtick&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;ytick&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">left</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;axes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">titlesize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">grid</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;axes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;grid&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;font&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="s">&quot;Palatino&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="o">=</span><span class="s">&quot;medium&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;figure&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;xtick.major&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s">&quot;ytick.major&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="defining-the-system">
<h2>Defining the system<a class="headerlink" href="#defining-the-system" title="Permalink to this headline">#</a></h2>
<p>First we’ll create an ion:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca40</span><span class="p">([(</span><span class="s">&quot;S1/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;D5/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="w"></span>
<span class="n">print</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Ion</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>true
</pre></div>
</div>
</div>
</div>
<p>As shown, <code class="docutils literal notranslate"><span class="pre">Ca40</span></code> is a composite type derived from the abstract type <code class="docutils literal notranslate"><span class="pre">Ion</span></code>. By giving the argument <code class="docutils literal notranslate"><span class="pre">[(&quot;S1/2&quot;,</span> <span class="pre">-1/2),</span> <span class="pre">(&quot;D5/2&quot;,</span> <span class="pre">-1/2)]</span></code> we’ve decided to only pay attention to these two electronic levels.</p>
<p>To see all of the options for <code class="docutils literal notranslate"><span class="pre">Ca40</span></code> we can look at its doc string, which can be accessed in Julia by typing <code class="docutils literal notranslate"><span class="pre">?</span></code> before the variable name:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">Ca40</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<p><code class="docutils literal notranslate"><span class="pre">Ca40(selected_sublevels::Vector{Tuple}[,</span> <span class="pre">starkshift::Dict])</span></code>
Ion instance of species Ca40</p>
<p><code class="docutils literal notranslate"><span class="pre">selected_sublevels</span></code> specifies which energy sublevels will be present in the Hilbert space of this Ion instance, as a subset of all possible sublevels.</p>
<p>Each element of <code class="docutils literal notranslate"><span class="pre">selected_sublevels</span></code> is a 2-element Tuple (level, sublevels), with the first element being the name of a level and the second specifying which sublevels should be included.
Allowed sublevels are those whose magnetic quantum number <code class="docutils literal notranslate"><span class="pre">m</span></code> is in the set {<code class="docutils literal notranslate"><span class="pre">-f</span></code>, <code class="docutils literal notranslate"><span class="pre">-f+1</span></code>, <code class="docutils literal notranslate"><span class="pre">-f+2</span></code>, … <code class="docutils literal notranslate"><span class="pre">f-1</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>}, where <code class="docutils literal notranslate"><span class="pre">f</span></code> is the total angular momentum quantum number of <code class="docutils literal notranslate"><span class="pre">level</span></code>.
For each <code class="docutils literal notranslate"><span class="pre">level</span></code> specified there are three allowed options to specify the set of <code class="docutils literal notranslate"><span class="pre">sublevels</span></code> to include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sublevels::Real</span></code>: Includes only one <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">sublevels</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sublevels::Vector{Real}</span></code>: Includes all sublevels whose magnetic quantum number <code class="docutils literal notranslate"><span class="pre">m</span></code> is in <code class="docutils literal notranslate"><span class="pre">sublevels</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sublevels</span> <span class="pre">=</span> <span class="pre">&quot;all&quot;</span></code>: Includes all allowed sublevels</p></li>
</ul>
<p>If instead <code class="docutils literal notranslate"><span class="pre">selected_sublevels</span> <span class="pre">=</span> <span class="pre">&quot;all&quot;</span></code>, then all sublevels of all levels are included.</p>
<p>Omission of a level in <code class="docutils literal notranslate"><span class="pre">selected_sublevels</span></code> will exclude all sublevels.</p>
<p><strong>Fields</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">species_properties::NamedTuple</span></code>: Contains constants specifying parameters specific to species</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sublevels</span></code>::Vector{Tuple{String,Real}}: List of all sublevels present in the Hilbert space</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sublevel_aliases::Dict{String,Tuple}</span></code>: Dict specifying aliases assigned to sublevels, in the format <code class="docutils literal notranslate"><span class="pre">alias</span> <span class="pre">=&gt;</span> <span class="pre">sublevel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>::Vector{Int}: Dimension of the Hilbert space</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stark_shift::OrderedDict</span></code>: A dictionary with keys denoting the selected levels and values, a real number for describing a shift of the level’s energy. This is just a convenient way to add Stark shifts to the simulation without additional resources</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ionnumber</span></code>: When the ion is added to an <code class="docutils literal notranslate"><span class="pre">IonConfiguration</span></code>, this value keeps track of its order in the chain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span></code>: When the ion is added to an <code class="docutils literal notranslate"><span class="pre">IonConfiguration</span></code>, this value keeps track of its physical position in meters</p></li>
</ul>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also preview the values of the various fields of our instantiated <code class="docutils literal notranslate"><span class="pre">C</span></code> by typing <code class="docutils literal notranslate"><span class="pre">C.</span></code> and pressing the tab key.</p>
</div>
</aside>
<p>In IonSim, electronic energy levels are labelled with a string (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;S1/2&quot;</span></code> in <code class="docutils literal notranslate"><span class="pre">Ca40</span></code>), and their magnetic sublevels are labelled with a <code class="docutils literal notranslate"><span class="pre">Tuple{String,</span> <span class="pre">Real}</span></code> where the string is the energy level label and the real number is the magnetic quantum number. The <code class="docutils literal notranslate"><span class="pre">&quot;S1/2&quot;</span></code> energy level of <code class="docutils literal notranslate"><span class="pre">Ca40</span></code> has two possible magnetic sublevels, <code class="docutils literal notranslate"><span class="pre">(&quot;S1/2&quot;,</span> <span class="pre">-1//2)</span></code> and <code class="docutils literal notranslate"><span class="pre">(&quot;S1/2&quot;,</span> <span class="pre">1//2)</span></code>.</p>
<p>Use of these tuples can get cumbersome, so IonSim allows you to assign <em>aliases</em> to sublevels, allowing you to refer to them by any convenient <code class="docutils literal notranslate"><span class="pre">String</span></code>.</p>
<p>We can assign some aliases to our chosen sublevels of our ion <code class="docutils literal notranslate"><span class="pre">C</span></code> with the help of the function <code class="docutils literal notranslate"><span class="pre">set_sublevel_alias!</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">set_sublevel_alias!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S1/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"></span>
<span class="w">                            </span><span class="s">&quot;D&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;D5/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Here we have assigned the alias <code class="docutils literal notranslate"><span class="pre">&quot;S&quot;</span></code> to the sublevel <code class="docutils literal notranslate"><span class="pre">(&quot;S1/2&quot;,</span> <span class="pre">-1//2)</span></code>, and the alias <code class="docutils literal notranslate"><span class="pre">&quot;D&quot;</span></code> to the sublevel <code class="docutils literal notranslate"><span class="pre">(&quot;D5/2&quot;,</span> <span class="pre">-1//2)</span></code>. We may now refer to these sublevels by these aliases in future function calls.</p>
<p>We can use the function <code class="docutils literal notranslate"><span class="pre">sublevel_aliases</span></code> to see all aliases assigned to a given <code class="docutils literal notranslate"><span class="pre">Ion</span></code>’s sublevels</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">sublevel_aliases</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dict{String, Tuple} with 2 entries:
  &quot;S&quot; =&gt; (&quot;S1/2&quot;, -1//2)
  &quot;D&quot; =&gt; (&quot;D5/2&quot;, -1//2)
</pre></div>
</div>
</div>
</div>
<p>We may undo any subset of these assignments with the function <code class="docutils literal notranslate"><span class="pre">clear_sublevel_alias!</span></code>, or all of them with the function <code class="docutils literal notranslate"><span class="pre">clear_all_sublevel_aliases!</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can see a full list of the functions available from IonSim by typing <code class="docutils literal notranslate"><span class="pre">IonSim.</span></code> and pressing the tab key. Functions beginning with an underscore are generally not meant to be accessed interactively. Everything else should have a doc string.</p>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">set_sublevel_alias!</span></code> has various methods that allow assignment of alises to ion sublevels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">set_sublevel_alias!</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>search: <span class=" -Color -Color-Bold">set_sublevel_alias!</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>set_sublevel_alias!(I::Ion, sublevel::Tuple{String,Real}, alias::String)
</pre></div>
</div>
<p>Assigns an alias <code class="docutils literal notranslate"><span class="pre">alias</span></code> to <code class="docutils literal notranslate"><span class="pre">sublevel</span></code> of <code class="docutils literal notranslate"><span class="pre">I</span></code>. This then allows one to pass <code class="docutils literal notranslate"><span class="pre">alias</span></code> in place of <code class="docutils literal notranslate"><span class="pre">sublevel</span></code> (for <code class="docutils literal notranslate"><span class="pre">I</span></code> only) into any function which accepts a sublevel as an argument.</p>
<hr class="docutils" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>set_sublevel_alias!(I::Ion, aliasassignments)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">aliasassignments</span></code> specifies which aliases should be assigned to which sublevels. There are two options to do this:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aliasassignments</span></code> is a Vector of Tuples, with the first element of each being the sublevel (<code class="docutils literal notranslate"><span class="pre">sublevel::Tuple{String,Real}</span></code>) and the second being its assigned alias (<code class="docutils literal notranslate"><span class="pre">alias::String</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aliasassignments</span></code> is a Dict with the format <code class="docutils literal notranslate"><span class="pre">alias::String</span> <span class="pre">=&gt;</span> <span class="pre">sublevel::Tuple{String,Real}</span></code></p></li>
</ul>
<p>Calls <code class="docutils literal notranslate"><span class="pre">set_sublevel_alias!(I,</span> <span class="pre">sublevel,</span> <span class="pre">alias)</span></code> for each pair <code class="docutils literal notranslate"><span class="pre">sublevel,</span> <span class="pre">alias</span></code>.</p>
</div>
</div>
<p>Next we’ll define a laser:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Laser</span><span class="p">()</span><span class="w"></span>
<span class="n">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>λ: nothing m
Δ: 0 Hz
ϵ̂: (x=0.7071067811865475, y=0.7071067811865475, z=0.0)
k̂: (z=0, y=0, z=1)
E(t=0): 0 V/m
ϕ(t=0): 0 ⋅ 2π
</pre></div>
</div>
</div>
</div>
<p>As shown, the default wavelength of <code class="docutils literal notranslate"><span class="pre">Laser</span></code> is set to <code class="docutils literal notranslate"><span class="pre">nothing</span></code>. Typically, one wishes to set a laser wavelength at or near resonance with a particular atomic transition. We will do this later once we have set up the rest of the system. As noted previously, to view the other attributes for <code class="docutils literal notranslate"><span class="pre">Laser</span></code> take a look at its doc string (or use <code class="docutils literal notranslate"><span class="pre">L.</span></code> + tabkey).</p>
<p>To include the center of mass motion of the ion in our simulation, we need to add it to an <code class="docutils literal notranslate"><span class="pre">IonConfiguration</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">chain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LinearChain</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">ions</span><span class="o">=</span><span class="p">[</span><span class="n">C</span><span class="p">],</span><span class="w"> </span><span class="n">com_frequencies</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mf">1e6</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">vibrational_modes</span><span class="o">=</span><span class="p">(;</span><span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">print</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">IonConfiguration</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>true
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">LinearChain</span></code> automatically computes the normal modes for a collection of ions (as input to keyword argument <code class="docutils literal notranslate"><span class="pre">ions</span></code>) in a linear Coloumb crystal with the given center of mass frequencies. By setting <code class="docutils literal notranslate"><span class="pre">vibrational_modes=(;z=[1])</span></code> we’ve decided to only consider the 1st normal mode along the ẑ-direction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">chain</span><span class="o">.</span><span class="n">vibrational_modes</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x = VibrationalMode[], y = VibrationalMode[], z = VibrationalMode[VibrationalMode(ν=1.0e6, axis=ẑ, N=10)])
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">vibrational_modes=(;z=[1])</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">vibrational_modes=(x=[],</span> <span class="pre">y=[],</span> <span class="pre">z=[1])</span></code> or <code class="docutils literal notranslate"><span class="pre">vibrational_modes=(y=[],</span> <span class="pre">z=[1])</span></code></p>
</div>
</aside>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ẑ is always assumed to be along the crystal’s axis of symmetry.</p>
</div>
</aside>
<p>The last thing we need to construct is a <code class="docutils literal notranslate"><span class="pre">Trap</span></code>, which collects all of these objects that we’ve defined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Trap</span><span class="p">(</span><span class="n">configuration</span><span class="o">=</span><span class="n">chain</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="o">=</span><span class="mf">4e-4</span><span class="p">,</span><span class="w"> </span><span class="n">Bhat</span><span class="o">=</span><span class="n">ẑ</span><span class="p">,</span><span class="w"> </span><span class="n">δB</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">lasers</span><span class="o">=</span><span class="p">[</span><span class="n">L</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">Trap</span></code> specifically associates an <code class="docutils literal notranslate"><span class="pre">IonConifiguration</span></code> and a set of lasers. It keeps track of which lasers point at which ions and with how much scaled strength (to model e.g. crosstalk). It also keeps track of the magnetic field. In this case we’ve set the magnetic field to have a strength of 4 Gauss and to point in the ẑ-direction. δB can be used to model a time-dependent magnetic field, which for example, might be useful to model noise – for now we set it to 0.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Though, mathematically, <code class="docutils literal notranslate"><span class="pre">C.basis</span> <span class="pre">⊗</span> <span class="pre">configuration.vibrational_modes.z[1].basis</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">configuration.vibrational_modes.z[1].basis</span> <span class="pre">⊗</span> <span class="pre">C.basis</span></code>, when converted to the space of 2D matrices the description of these two bases will be different. Equivalence is maintained provided that the order is consistent throughout the description of the problem, but this requires us to set a convention. For a trap composed of a linear chain of ions, IonSim’s convention is: ion₁ ⊗ ion₂ ⊗ … ⊗ ionₙ ⊗ mode₁ ⊗ mode₂ ⊗ … ⊗ modeₙ, where the ion bases are ordered according to the order in <code class="docutils literal notranslate"><span class="pre">T.configuration.ions</span></code> and the vibrational modes are ordered according to the order in <code class="docutils literal notranslate"><span class="pre">[T.configuration.vibrational_modes.x,</span> <span class="pre">T.configuration.vibrational_modes.y,</span> <span class="pre">T.configuration.vibrational_modes.z</span></code>].</p>
</div>
</section>
<section id="simulating-basic-dynamics">
<h2>Simulating basic dynamics<a class="headerlink" href="#simulating-basic-dynamics" title="Permalink to this headline">#</a></h2>
<section id="carrier-rabi-oscillations">
<h3>Carrier Rabi oscillations<a class="headerlink" href="#carrier-rabi-oscillations" title="Permalink to this headline">#</a></h3>
<p>Let’s start off by simulating rabi oscillations between the two considered states of our ion. First we have to update some of the parameters in our system.</p>
<p>First let’s set the wavelength of our laser. Here we want to set the wavelength such that the laser is resonant with the <code class="docutils literal notranslate"><span class="pre">&quot;S&quot;</span> <span class="pre">-&gt;</span> <span class="pre">&quot;D&quot;</span></code> transition in the <code class="docutils literal notranslate"><span class="pre">Ion</span></code> <code class="docutils literal notranslate"><span class="pre">C</span></code>. This can be done with the function <code class="docutils literal notranslate"><span class="pre">transitionwavlength</span></code> and passing in the arguments <code class="docutils literal notranslate"><span class="pre">C</span></code> (the ion), <code class="docutils literal notranslate"><span class="pre">(&quot;S&quot;,</span> <span class="pre">&quot;D&quot;)</span></code> (the transition), and <code class="docutils literal notranslate"><span class="pre">T</span></code> (the trap in which <code class="docutils literal notranslate"><span class="pre">C</span></code> resides). By including <code class="docutils literal notranslate"><span class="pre">T</span></code> in our function call, the <code class="docutils literal notranslate"><span class="pre">transitionwavlength</span></code> takes into account the energy shift due to the magnetic field inside the <code class="docutils literal notranslate"><span class="pre">Trap</span></code> <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">λ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transitionwavelength</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Due to selection rules and because we’ve defined our magnetic field to point in the ẑ-direction we need to update the geometry of our laser to have a nonzero coupling to this transition:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x̂</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ẑ</span><span class="p">)</span><span class="o">/√</span><span class="mi">2</span><span class="w"> </span>
<span class="n">L</span><span class="o">.</span><span class="n">ϵ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x̂</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ẑ</span><span class="p">)</span><span class="o">/√</span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we should set the laser’s electric field amplitude (at the position of the ion) to something reasonable. For this we use the convenience function <code class="docutils literal notranslate"><span class="pre">Efield_from_pi_time!</span></code></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It’s customary in Julia to end the names of functions that update their arguments in-place with a “!”.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">Efield_from_pi_time!</span><span class="p">(</span><span class="mf">2e-6</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">));</span><span class="w">  </span><span class="c"># Sets pi_time to 2 μs</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-stderr tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">Efield_from_pi_time</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Efield_from_rabi_frequency!(
        Ω::Real, Bhat::NamedTuple{(:x,:y,:z)}, laser::Laser, ion::Ion, 
        transition::Union{Tuple{String,String},Vector{&lt;:String}}
    )
</pre></div>
</div>
<p>Same as [<code class="docutils literal notranslate"><span class="pre">Efield_from_rabi_frequency</span></code>], but updates <code class="docutils literal notranslate"><span class="pre">laser[:E]</span></code> in-place.</p>
</div>
<p>The last thing we need to do before we run our simulation is to construct the hamiltonian:</p>
<div class="cell tag_remove-stderr tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">hamiltonian</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hamiltonian</span><span class="p">(</span>
            <span class="n">T</span><span class="p">::</span><span class="n">Trap</span><span class="p">;</span> <span class="n">timescale</span><span class="p">::</span><span class="n">Real</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">lamb_dicke_order</span><span class="p">::</span><span class="n">Union</span><span class="p">{</span><span class="n">Vector</span><span class="p">{</span><span class="n">Int</span><span class="p">},</span><span class="n">Int</span><span class="p">}</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
            <span class="n">rwa_cutoff</span><span class="p">::</span><span class="n">Real</span><span class="o">=</span><span class="n">Inf</span><span class="p">,</span> <span class="n">displacement</span><span class="o">=</span><span class="s2">&quot;truncated&quot;</span><span class="p">,</span> <span class="n">time_dependent_eta</span><span class="o">=</span><span class="n">false</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Constructs the Hamiltonian for <code class="docutils literal notranslate"><span class="pre">T</span></code> as a function of time. Return type is a function
<code class="docutils literal notranslate"><span class="pre">h(t::Real,</span> <span class="pre">ψ)</span></code> that, itself, returns a <code class="docutils literal notranslate"><span class="pre">QuantumOptics.SparseOperator</span></code>.</p>
<p><strong>args</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">timescale</span></code>: e.g. a value of 1e-6 will take time to be in <code class="docutils literal notranslate"><span class="pre">\\mu</span> <span class="pre">s</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lamb_dicke_order</span></code>: Only consider terms that change the phonon number by up to this value.
If this is an <code class="docutils literal notranslate"><span class="pre">Int</span></code>, then the cutoff is applied to all modes. If this is a <code class="docutils literal notranslate"><span class="pre">Vector{Int}</span></code>,
then <code class="docutils literal notranslate"><span class="pre">lamb_dicke_order[i]</span></code> is applied to the iᵗʰ mode, according to the order in
<code class="docutils literal notranslate"><span class="pre">T.basis</span></code>.
Note: this isn’t quite the same thing as the Lamb-Dicke approximation since setting
<code class="docutils literal notranslate"><span class="pre">lamb_dicke_order=1</span></code> will retain, for example, terms proportional to <code class="docutils literal notranslate"><span class="pre">a^\\dagger</span> <span class="pre">a</span> </code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rwa_cutoff</span></code>: drop terms in the Hamiltonian that oscillate faster than this cutoff.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">displacement</span></code>: This can be either <code class="docutils literal notranslate"><span class="pre">&quot;truncated&quot;</span></code>(default) or <code class="docutils literal notranslate"><span class="pre">&quot;analytic&quot;</span></code>.</p>
<p>When an atom is irradiated, both the atom’s energy and its momentum will generally be
affected. For an atom in a harmonic potential, the exchange of momentum can be modeled as
a displacement operation <code class="docutils literal notranslate"><span class="pre">D(α=iηe^{-iνt})</span> <span class="pre">=</span> <span class="pre">exp[αa^†</span> <span class="pre">-</span> <span class="pre">α^*a]</span></code>, where <code class="docutils literal notranslate"><span class="pre">η</span></code> is the
Lamb-Dicke parameter, which can be described equivalently as either being proportional to
the square root of the ratio of the recoil frequency with the ground state energy of the
atom’s motion or as the ratio of the spread of the ground state wavefunction to the
wavelength of the laser.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">&quot;truncated&quot;</span></code> is selected, the matrix elements of <code class="docutils literal notranslate"><span class="pre">D(α)</span></code> are computed by
constructing <code class="docutils literal notranslate"><span class="pre">α^*</span> <span class="pre">a,</span> <span class="pre">αa^†</span></code> in a truncated basis (according to the dimension specified in
your model) and then exponentiating their difference. This has the advantage, amongst
other things, of guaranting unitarity.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">&quot;analytic&quot;</span></code> is selected, then the matrix elements are computed assuming an infinite-
dimensional Hilbert space.</p>
<p>For small displacements (<code class="docutils literal notranslate"><span class="pre">η</span> <span class="pre">≪</span> <span class="pre">N</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the dimension of the motion’s Hilbert
space), both of these methods will be good approximations.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_dependent_eta::Bool</span></code>: In addition to impacting the vibrational subspace directly, a
change in the trap frequency, <code class="docutils literal notranslate"><span class="pre">δν</span></code>, will also change the Lamb-Dicke parameter. Since
typically <code class="docutils literal notranslate"><span class="pre">δν≪ν</span></code>, this effect will be small <code class="docutils literal notranslate"><span class="pre">η</span> <span class="pre">≈</span> <span class="pre">η₀(1</span> <span class="pre">+</span> <span class="pre">δν/2ν)</span></code> and doesn’t warrant
the additional computational resources needed to calculate and update it in time. In this
case, we can set <code class="docutils literal notranslate"><span class="pre">time_dependent_eta=false</span></code> (default), which will set <code class="docutils literal notranslate"><span class="pre">η(t)</span> <span class="pre">=</span> <span class="pre">η₀</span></code>.</p></li>
</ul>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>setting timescale=1e-6 sets the units of time to μs</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">timescale</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Now we can take <code class="docutils literal notranslate"><span class="pre">h</span></code> and feed it into one of the <a class="reference external" href="https://qojulia.org/documentation/timeevolution/timeevolution/"><code class="docutils literal notranslate"><span class="pre">QuantumOptics.timeevolution</span></code></a> solvers:</p>
<div class="cell tag_remove-input tag_remove-output docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.01</span><span class="o">:</span><span class="mi">10</span><span class="w"></span>
<span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">vibrational_modes</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ionstate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.006832 seconds (85.47 k allocations: 2.723 MiB)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/getting_started_64_0.png" src="../_images/getting_started_64_0.png" />
</div>
</div>
<p>In the above plot, we see Rabi oscillations with a pi-time of 2 μs, as expected.</p>
<p>Now if we add a detuning to the laser equal to the Rabi frequency, we should see oscillation with half the amplitude and √2 times the frequency:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.5e5</span><span class="w"></span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">timescale</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ionstate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.025176 seconds (81.07 k allocations: 2.611 MiB)
</pre></div>
</div>
<img alt="../_images/getting_started_66_1.png" src="../_images/getting_started_66_1.png" />
</div>
</div>
<p>We can achieve the same effect by instead setting a nonzero value in our ion’s <code class="docutils literal notranslate"><span class="pre">stark_shift</span></code> field. This can be useful when we have several ions in our chain and want to simulate a Stark shift without involving an additional laser resource.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="n">set_stark_shift!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.25e5</span><span class="p">)</span><span class="w"></span>
<span class="n">set_stark_shift!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.25e5</span><span class="p">)</span><span class="w"></span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">timescale</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ionstate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.030257 seconds (95.18 k allocations: 2.980 MiB)
</pre></div>
</div>
<img alt="../_images/getting_started_68_1.png" src="../_images/getting_started_68_1.png" />
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">ion_state(T,</span> <span class="pre">&quot;S&quot;)</span> <span class="pre">⊗</span> <span class="pre">fockstate(mode.basis,</span> <span class="pre">0)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">C[&quot;S&quot;]</span> <span class="pre">⊗</span> <span class="pre">mode[0]</span></code>.</p>
</div>
</aside>
<p>So far our simulations have used an initial state <code class="docutils literal notranslate"><span class="pre">ion_state(T,</span> <span class="pre">&quot;S&quot;)</span> <span class="pre">⊗</span> <span class="pre">fockstate(mode.basis,</span> <span class="pre">0)</span></code>, or <span class="math notranslate nohighlight">\(|S, n=0\rangle\)</span>, but we can also start off with the vibrational mode in a thermal state:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">dm(C[&quot;S&quot;])</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">C[&quot;S&quot;]</span> <span class="pre">⊗</span> <span class="pre">C[&quot;S&quot;]'</span></code> and corresponds to
<span class="math notranslate nohighlight">\(|S⟩⟨S|\)</span>.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">ψi_ion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">])</span><span class="w"> </span>
<span class="n">mode</span><span class="o">.</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="n">ψi_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">thermalstate</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"></span>
<span class="n">ψi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ψi_ion</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">ψi_mode</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">timescale</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="n">rwa_cutoff</span><span class="o">=</span><span class="nb">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">time_dependent_eta</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="o">=</span><span class="s">&quot;truncated&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ψi</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-output tag_remove-input docutils container">
</div>
<p>We can compare this result with the analytical expression which can be found in IonSim’s <code class="docutils literal notranslate"><span class="pre">analytical</span></code> module:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">analytical</span><span class="o">.</span><span class="n">rabi_flop</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<p><code class="docutils literal notranslate"><span class="pre">rabi_flop(tspan,</span> <span class="pre">Ω::Real,</span> <span class="pre">η::Real,</span> <span class="pre">n̄::Real;</span> <span class="pre">s::Int=0)</span></code></p>
<p>Single ion rabi flop. Returns:
$<span class="math notranslate nohighlight">\(
\sum_{n=0}^∞ p_n sin^2(\Omega_n t)
\)</span><span class="math notranslate nohighlight">\(
with
\)</span><span class="math notranslate nohighlight">\(
\Omega_n = Ωe^{-η^2/2}η^s\sqrt{\frac{n!}{(n+s)!}}L_{n}^{s}(η^2)
\)</span><span class="math notranslate nohighlight">\(
where ``s`` is the order of the (blue) sideband that we are driving and \)</span>L_{n}^{s}$ is the
associated Laguerre polynomial. <a class="reference external" href="https://doi.org/10.1103/RevModPhys.75.281">ref</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;numerical&quot;</span><span class="p">)</span><span class="w"></span>

<span class="n">η</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_η</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">analytical</span><span class="o">.</span><span class="n">rabi_flop</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">η</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;analytical&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/getting_started_77_0.png" src="../_images/getting_started_77_0.png" />
</div>
</div>
<p>We see good, but not perfect agreement between the two curves. In fact, the majority of this discrepancy comes from off-resonant interaction with the first order sideband which the simulation captures but the analytical solution does not.</p>
<p>This can be confirmed by eliminating this off-resonant interaction in our simulation by setting they keyword argument <code class="docutils literal notranslate"><span class="pre">lamb_dicke_order</span></code> in the <code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code> function to zero (by default, this is set to 1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">lamb_dicke_order</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="c"># set lamb_dicke_order here</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ψi</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2.987212 seconds (721.65 k allocations: 342.104 MiB)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;numerical&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">η</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_η</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">analytical</span><span class="o">.</span><span class="n">rabi_flop</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">η</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;analytical&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/getting_started_80_0.png" src="../_images/getting_started_80_0.png" />
</div>
</div>
<p>Which givesa a much better agreement between the two curves.</p>
<p>At this point, it’s worth explaining in more detail what we’ve just done. Conventionally, we would probably guess that setting the <code class="docutils literal notranslate"><span class="pre">lamb_dicke_order</span></code> to <code class="docutils literal notranslate"><span class="pre">n</span></code> would be equivalent to truncating the Taylor series expansion of the displacement operator <span class="math notranslate nohighlight">\(D(iη e^{iνt})\)</span> after the <span class="math notranslate nohighlight">\(n^{th}\)</span> order in η.</p>
<p>But this is not what IonSim does. Instead, it just drops all (Fock basis) matrix elements of <span class="math notranslate nohighlight">\(\langle m | D | n \rangle\)</span> where <span class="math notranslate nohighlight">\(|m-n| &gt; n\)</span>.</p>
<p>All matrix elements of the operator are computed <a class="reference external" href="https://doi.org/10.1103/PhysRev.177.1857">analytically</a>. So, for example, even if we set <code class="docutils literal notranslate"><span class="pre">lamb_dicke_order=0</span></code>, we’ll still retain the precise effect that the mode coupling has on the carrier transition – as in the above example.</p>
</section>
<section id="sideband-transitions">
<h3>Sideband Transitions<a class="headerlink" href="#sideband-transitions" title="Permalink to this headline">#</a></h3>
<p>Let’s see some examples of driving sideband transitions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">100</span><span class="w"></span>
<span class="c"># set the motional dimension back to 10</span><span class="w"></span>
<span class="n">mode</span><span class="o">.</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span>

<span class="c"># tune laser frequency to blue sideband</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w">  </span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol_blue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="c"># tune laser frequency to red sideband</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w">  </span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol_red</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex_blue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol_blue</span><span class="p">)</span><span class="w"></span>
<span class="n">ex_red</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol_red</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex_blue</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;blue sideband&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex_red</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;red sideband&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.562572 seconds (1.14 M allocations: 30.204 MiB, 75.87% gc time)
  0.074577 seconds (1.23 M allocations: 32.719 MiB)
</pre></div>
</div>
<img alt="../_images/getting_started_84_1.png" src="../_images/getting_started_84_1.png" />
</div>
</div>
<p>The fast oscillations come from off-resonant excitation of the carrier transition. The slower oscillations are from population being driven back and forth between <span class="math notranslate nohighlight">\(|S, n=0\rangle \leftrightarrow |D, n=1 \rangle\)</span>. We only see these when detuning blue, because we start with the vibrational mode in the ground state (<code class="docutils literal notranslate"><span class="pre">mode[0]</span></code>).</p>
<p>If we instead start out in <code class="docutils literal notranslate"><span class="pre">mode[1]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w">  </span><span class="c"># tune laser frequency to blue sideband</span><span class="w"></span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol_blue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ionstate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">fockstate</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w">  </span><span class="c"># tune laser frequency to red sideband</span><span class="w"></span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">rwa_cutoff</span><span class="o">=</span><span class="mf">1e7</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol_red</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ionstate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">fockstate</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex_blue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol_blue</span><span class="p">)</span><span class="w"></span>
<span class="n">ex_red</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol_red</span><span class="p">)</span><span class="w"></span>
<span class="n">step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">step</span><span class="o">:</span><span class="n">end</span><span class="p">],</span><span class="w"> </span><span class="n">ex_blue</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">step</span><span class="o">:</span><span class="n">end</span><span class="p">],</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;blue sideband&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">step</span><span class="o">:</span><span class="n">end</span><span class="p">],</span><span class="w"> </span><span class="n">ex_red</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">step</span><span class="o">:</span><span class="n">end</span><span class="p">],</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;red sideband&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time [μs]&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.161255 seconds (1.31 M allocations: 34.835 MiB, 9.29% compilation time)
  0.108735 seconds (1.27 M allocations: 33.826 MiB)
</pre></div>
</div>
<img alt="../_images/getting_started_86_1.png" src="../_images/getting_started_86_1.png" />
</div>
</div>
<p>The large detuning is coming almost entirely from an AC Stark shift off of the carrier transition.</p>
<p>We can confirm this by using they <code class="docutils literal notranslate"><span class="pre">rwa_cutoff</span></code> keyword in the <code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code> function. Setting <code class="docutils literal notranslate"><span class="pre">rwa_cutoff=x</span></code>, will neglect all terms in the Hamiltonian that oscillate faster than <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This doesn’t apply to user-defined time-dependent parameters (described in the next section).</p>
</div>
</aside>
<p>Since the vibrational mode frequency has been set to 1 MHz, if we set <code class="docutils literal notranslate"><span class="pre">rwa_cutoff=1e5</span></code>, we should neglect the carrier Stark shift in our simulation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># tune laser frequency to blue sideband</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w">  </span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">rwa_cutoff</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span><span class="w"> </span><span class="c"># set rwa_cutoff here</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol_blue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="c"># tune laser frequency to red sideband</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w">  </span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">rwa_cutoff</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span><span class="w"> </span><span class="c"># set rwa_cutoff here</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol_red</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex_blue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol_blue</span><span class="p">)</span><span class="w"></span>
<span class="n">ex_red</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol_red</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex_blue</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;blue sideband&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex_red</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;red sideband&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.003557 seconds (16.61 k allocations: 945.422 KiB)
  0.002880 seconds (13.25 k allocations: 855.422 KiB)
</pre></div>
</div>
<img alt="../_images/getting_started_88_1.png" src="../_images/getting_started_88_1.png" />
</div>
</div>
<p>A final note about the <code class="docutils literal notranslate"><span class="pre">rwa_cutoff</span></code>:
If <code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code> knows that you’re not performing an RWA, it can do some optimization to reduce the number of internal functions that need to be evaluated, leading to faster performance. We can let it know that we’re not performing an RWA by setting <code class="docutils literal notranslate"><span class="pre">rwa_cutoff=Inf</span></code> (this is the default value).</p>
<p>To reiterate: if you’re not performing an RWA, then setting <code class="docutils literal notranslate"><span class="pre">rwa_cutoff</span></code> equal to <code class="docutils literal notranslate"><span class="pre">Inf</span></code>, rather than some arbitrarily large value, will lead to faster performance.</p>
</section>
<section id="time-dependent-parameters">
<h3>Time-dependent parameters<a class="headerlink" href="#time-dependent-parameters" title="Permalink to this headline">#</a></h3>
<p>All of the parameters denoted as time-dependent in the Hamiltonian equation at the start of this notebook can be set to arbitrary single-valued functions by the user. This can be useful for things like optimal control and modeling noise.</p>
<p>Below we’ll give a couple of examples of this.</p>
<p>First we note that the Stark shift-induced detuning of the BSB Rabi flop in the previous section can be compensated by adding an additional detuning to the laser:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># add additional detuning to BSB to compensate for carrier Stark shift</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">31e3</span><span class="w"></span>

<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">60</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.108542 seconds (745.29 k allocations: 19.808 MiB)
</pre></div>
</div>
<img alt="../_images/getting_started_93_1.png" src="../_images/getting_started_93_1.png" />
</div>
</div>
<p>However, we’re still stuck with the off-resonant population oscillations from the carrier transition. It turns out we can eliminate these by ramping up the amplitude of the laser at the beginning of the simulation.</p>
<p>Such a ramp can be set with the <code class="docutils literal notranslate"><span class="pre">:E</span></code> field of the laser:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># get previous value of electric field strength</span><span class="w"></span>
<span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Efield_from_pi_time</span><span class="p">(</span><span class="mf">2e-6</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">))</span><span class="w"> </span>

<span class="c"># Simple amplitude ramping function</span><span class="w"></span>
<span class="k">function</span><span class="w"> </span><span class="n">Ω</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="nb">π</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="n">E</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">L</span><span class="o">.</span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ω</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># add additional detuning to BSB to compensate for carrier Stark shift</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">31e3</span><span class="w"></span>

<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">60</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="nd">@.</span><span class="p">(</span><span class="n">Ω</span><span class="p">(</span><span class="n">tout</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="n">E</span><span class="p">),</span><span class="w"> </span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;scaled ramp&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.194442 seconds (1.18 M allocations: 29.595 MiB, 21.17% compilation time)
</pre></div>
</div>
<img alt="../_images/getting_started_96_1.png" src="../_images/getting_started_96_1.png" />
</div>
</div>
<p>To be a bit more succinct we can use a Julia <em>anonymous function</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># To make things interesting let&#39;s also reduce the ramp time from 4 μs to 1 μs</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w">  </span><span class="n">E</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="nb">π</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">E</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># add additional detuning to BSB to compensate for carrier Stark shift</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">31e3</span><span class="w"></span>

<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">60</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="nd">@.</span><span class="p">(</span><span class="n">Ω</span><span class="p">(</span><span class="n">tout</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="n">E</span><span class="p">),</span><span class="w"> </span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;scaled ramp&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.136566 seconds (1.18 M allocations: 29.703 MiB)
</pre></div>
</div>
<img alt="../_images/getting_started_99_1.png" src="../_images/getting_started_99_1.png" />
</div>
</div>
<p>Even with just a 1 μs ramp, we already see noticeable reduction of the fast oscillations.</p>
<p>As an applied example of a time-dependent laser frequency, we can simulate Rapid Adiabatic Passage or RAP <span id="id2">[<a class="reference internal" href="#id5" title="Chr. Wunderlich, Th. Hannemann, T. Körber, H. Häffner, Ch. Roos, W. Hänsel, R. Blatt, and F. Schmidt-Kaler. Robust state preparation of a single trapped ion by adiabatic passage. Journal of Modern Optics, 54(11):1541-1549, 2007. URL: https://doi.org/10.1080/09500340600741082, arXiv:https://doi.org/10.1080/09500340600741082, doi:10.1080/09500340600741082.">WHK+07</a>]</span>, which can be used for robust preparation of the ion in an excited state.</p>
<hr class="docutils" />
<p>We’ll linearly sweep through the laser’s frequency from -150 kHz to +150 kHz detuned from the carrier transition
in a time <code class="docutils literal notranslate"><span class="pre">Tp</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># the length of time of the frequency chirp in μs</span><span class="w"></span>
<span class="n">Tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">150</span><span class="w"></span>

<span class="c"># Δϕ is equal to half the detuning range we will chirp the laser over multiplied by the timescale (1e-6)</span><span class="w"></span>
<span class="n">Δϕ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="nb">π</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">150e-3</span><span class="w"></span>

<span class="c"># Set the frequency chirp</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">ϕ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="n">Δϕ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="n">Δϕ</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Tp</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>We’ll also ramp the Rabi frequency:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note I wasn’t able to match the results from the paper when using a Gaussian profile, as they
as described in the referenced paper, so instead I use a sin^2 profile.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Efield_from_pi_time</span><span class="p">(</span><span class="mf">6.5e-6</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">))</span><span class="w"></span>
<span class="n">tr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">33</span><span class="w"></span>
<span class="k">function</span><span class="w"> </span><span class="n">Ω</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">tr</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="nb">π</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="n">tr</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="w"></span>
<span class="w">    </span><span class="k">elseif</span><span class="w"> </span><span class="n">tr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">150</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tr</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">E</span><span class="w"></span>
<span class="w">    </span><span class="k">elseif</span><span class="w"> </span><span class="mi">150</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">150</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="nb">π</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">150</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="n">tr</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ω</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Set the B-field to match the value in the reference</span><span class="w"></span>
<span class="n">T</span><span class="o">.</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.9e-4</span><span class="w"></span>

<span class="c"># set detuning back to carrier at new magnetic field</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">λ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transitionwavelength</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">);</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">Δ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">175</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="nd">@.</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">E</span><span class="p">(</span><span class="n">tout</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="n">E</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;scaled amplitude profile&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="nd">@.</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">ϕ</span><span class="p">(</span><span class="n">tout</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="n">Δϕ</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tout</span><span class="p">)),</span><span class="w"> </span>
<span class="w">        </span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;scaled frequency profile&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.244281 seconds (3.29 M allocations: 67.342 MiB, 16.12% gc time)
</pre></div>
</div>
<img alt="../_images/getting_started_106_1.png" src="../_images/getting_started_106_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">detuning_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="nb">π</span><span class="o">*</span><span class="mf">1e-6</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">collect</span><span class="p">(</span><span class="mf">1e3</span><span class="o">:</span><span class="mf">2e4</span><span class="o">:</span><span class="mf">2e6</span><span class="p">)</span><span class="w"></span>
<span class="n">pops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}(</span><span class="nb">undef</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="n">Δϕ</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">detuning_range</span><span class="w"></span>
<span class="w">    </span><span class="n">L</span><span class="o">.</span><span class="n">ϕ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="n">Δϕ</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">Δϕ</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Tp</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="w"></span>
<span class="w">    </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">push!</span><span class="p">(</span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)[</span><span class="k">end</span><span class="p">]))</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nd">@.</span><span class="p">(</span><span class="n">detuning_range</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e3</span><span class="p">),</span><span class="w"> </span><span class="n">pops</span><span class="p">,</span><span class="w"> </span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;C1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">detuning_range</span><span class="p">[</span><span class="k">end</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e3</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.01</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Final Excited State</span><span class="se">\n</span><span class="s">Population&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;detuning range (kHz)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/getting_started_107_0.png" src="../_images/getting_started_107_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># get rid of frequency chirp</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">ϕ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="noise-in-progress">
<h3>Noise (in progress)<a class="headerlink" href="#noise-in-progress" title="Permalink to this headline">#</a></h3>
<p>QuantumOptics has several solvers that can incorporate noise. Here are some examples for using these with IonSim.</p>
<p>First we’ll consider decoherence of the state <span class="math notranslate nohighlight">\(|\psi\rangle = |S\rangle + |D\rangle\)</span> due to B-field fluctuations, which can be implemented by setting <code class="docutils literal notranslate"><span class="pre">T.δB</span></code> which has units of Tesla (we won’t do it here, but this value can also be made time-dependent).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">StochasticDiffEq</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collect</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mf">10.</span><span class="o">:</span><span class="mi">30000</span><span class="p">)</span><span class="w"></span>
<span class="n">β</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-2</span><span class="w"></span>
<span class="n">σ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">√</span><span class="p">(</span><span class="mi">2</span><span class="n">β</span><span class="p">)</span><span class="w"></span>
<span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StochasticDiffEq</span><span class="o">.</span><span class="n">OrnsteinUhlenbeckProcess</span><span class="p">(</span><span class="n">β</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">σ</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"></span>
<span class="n">w</span><span class="o">.</span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;O-U noise&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">warray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">w</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">tspan</span><span class="p">]</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">warray</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/getting_started_114_0.png" src="../_images/getting_started_114_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">DSP</span><span class="o">:</span><span class="w"> </span><span class="n">periodogram</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">sample_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">tspan</span><span class="p">[</span><span class="k">end</span><span class="p">]</span><span class="w"></span>
<span class="n">pwarray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">periodogram</span><span class="p">(</span><span class="n">warray</span><span class="p">,</span><span class="w"> </span><span class="n">fs</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span><span class="w"></span>
<span class="n">freqs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pwarray</span><span class="o">.</span><span class="n">freq</span><span class="w"></span>
<span class="n">abs_freqs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freqs</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="mf">1e6</span><span class="w"></span>
<span class="n">powers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pwarray</span><span class="o">.</span><span class="n">power</span><span class="w"></span>
<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StochasticDiffEq</span><span class="o">.</span><span class="n">OrnsteinUhlenbeckProcess</span><span class="p">(</span><span class="n">β</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">σ</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">w</span><span class="o">.</span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w"></span>
<span class="w">    </span><span class="n">warray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">w</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">tspan</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="n">powers</span><span class="w"> </span><span class="o">.+=</span><span class="w"> </span><span class="n">periodogram</span><span class="p">(</span><span class="n">warray</span><span class="p">,</span><span class="w"> </span><span class="n">fs</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span><span class="o">.</span><span class="n">power</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="n">powers</span><span class="w"> </span><span class="o">./=</span><span class="w"> </span><span class="n">powers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>

<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">abs_freqs</span><span class="p">,</span><span class="w"> </span><span class="n">powers</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;numerical&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">ou_psd</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">σ</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">β</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">π</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">abs_freqs</span><span class="p">,</span><span class="w"> </span><span class="n">ou_psd</span><span class="o">.</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">ou_psd</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;C1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;theoretical&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ls</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;relative power&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;frequency [Hz]&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;O-U PSD&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">10e-3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="w"> </span><span class="mf">2e4</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/getting_started_116_0.png" src="../_images/getting_started_116_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Let&#39;s create a new Ion with the right energy sublevels for a Δm = 2 transition</span><span class="w"></span>
<span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca40</span><span class="p">([(</span><span class="s">&quot;S1/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;D5/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="w"></span>
<span class="n">set_sublevel_alias!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S1/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"></span>
<span class="w">                            </span><span class="s">&quot;D&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;D5/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span><span class="w"></span>

<span class="c"># Create a new Trap with the new Ion</span><span class="w"></span>
<span class="n">chain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LinearChain</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">ions</span><span class="o">=</span><span class="p">[</span><span class="n">C</span><span class="p">],</span><span class="w"> </span><span class="n">com_frequencies</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mf">1e6</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">vibrational_modes</span><span class="o">=</span><span class="p">(;</span><span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="w"></span>

<span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Trap</span><span class="p">(</span><span class="n">configuration</span><span class="o">=</span><span class="n">chain</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="o">=</span><span class="mf">4e-4</span><span class="p">,</span><span class="w"> </span><span class="n">Bhat</span><span class="o">=</span><span class="n">ẑ</span><span class="p">,</span><span class="w"> </span><span class="n">δB</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">lasers</span><span class="o">=</span><span class="p">[</span><span class="n">L</span><span class="p">]);</span><span class="w"></span>

<span class="c"># Redefine mode for new trap</span><span class="w"></span>
<span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">vibrational_modes</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>

<span class="c"># Display sublevels of new ion</span><span class="w"></span>
<span class="n">sublevels</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">ions</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2-element Vector{Tuple{String, Real}}:
 (&quot;S1/2&quot;, -1//2)
 (&quot;D5/2&quot;, -5//2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># we&#39;re not paying attention to the vibrational mode here, so we set its dimension to 1,</span><span class="w"></span>
<span class="c"># effectively ignoring it</span><span class="w"></span>
<span class="n">mode</span><span class="o">.</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="c"># construct a zero operator</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">T</span><span class="o">.</span><span class="n">δB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>

<span class="c"># construct noise operator</span><span class="w"></span>
<span class="n">T</span><span class="o">.</span><span class="n">δB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5e-1</span><span class="w"></span>
<span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="n">hsvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">ψ</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">hs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">ψ</span><span class="p">)]</span><span class="w"></span>

<span class="n">ψi_ion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;D&quot;</span><span class="p">])</span><span class="o">/√</span><span class="mi">2</span><span class="w"></span>
<span class="n">ψi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ψi_ion</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>

<span class="n">Ntraj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span><span class="w"></span>

<span class="c"># iterate SDE solver Ntraj times and average results</span><span class="w"></span>
<span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StochasticDiffEq</span><span class="o">.</span><span class="n">OrnsteinUhlenbeckProcess</span><span class="p">(</span><span class="n">β</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">σ</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">Ntraj</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">mod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stochastic</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ψi</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">hsvec</span><span class="p">,</span><span class="w"> </span><span class="n">noise</span><span class="o">=</span><span class="n">w</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">normalize_state</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">ex</span><span class="w"> </span><span class="o">.+=</span><span class="w"> </span><span class="n">real</span><span class="o">.</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">dm</span><span class="p">(</span><span class="n">ψi_ion</span><span class="p">)</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">mode</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">))</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">Ntraj</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;C0&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Simulated Contrast&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tspan</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Ramsey Signal&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
11
21
31
41
51
61
71
81
91
</pre></div>
</div>
<img alt="../_images/getting_started_118_1.png" src="../_images/getting_started_118_1.png" />
</div>
</div>
<p>We can compare the same magnitude of B-field fluctuations for a white PSD. We could use the stochastic solver again, but instead let’s use a Lindblad master equation solver:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">γ1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hs</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">40</span><span class="w"></span>
<span class="n">γ2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hs</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">40</span><span class="w"></span>

<span class="n">rates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="nb">π</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">abs</span><span class="o">.</span><span class="p">([</span><span class="n">γ1</span><span class="p">,</span><span class="w"> </span><span class="n">γ2</span><span class="p">])</span><span class="w"></span>

<span class="n">hs1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="o">&#39;</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span><span class="w"></span>
<span class="n">hs2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;D&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;D&quot;</span><span class="p">]</span><span class="o">&#39;</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span><span class="w"></span>

<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collect</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mf">1.</span><span class="o">:</span><span class="mi">30000</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">master</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">dm</span><span class="p">(</span><span class="n">ψi</span><span class="p">),</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="n">hs1</span><span class="p">,</span><span class="w"> </span><span class="n">hs2</span><span class="p">],</span><span class="w"> </span><span class="n">rates</span><span class="o">=</span><span class="n">rates</span><span class="p">,</span><span class="w"> </span><span class="n">maxiters</span><span class="o">=</span><span class="mf">1e8</span><span class="p">)</span><span class="w"></span>

<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">dm</span><span class="p">(</span><span class="n">ψi_ion</span><span class="p">)</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">mode</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tspan</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Ramsey Contrast&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>428.153191 seconds (22.26 k allocations: 5.085 MiB)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>PyError ($(Expr(:escape, :(ccall(#= /home/neil/.julia/packages/PyCall/7a7w0/src/pyfncall.jl:43 =# @pysym(:PyObject_Call), PyPtr, (PyPtr, PyPtr, PyPtr), o, pyargsptr, kw))))) &lt;class &#39;ValueError&#39;&gt;
ValueError(&#39;x and y must have same first dimension, but have shapes (30001,) and (10638,)&#39;)
  File &quot;/home/neil/miniconda3/envs/sims/lib/python3.8/site-packages/matplotlib/pyplot.py&quot;, line 2794, in plot
    return gca().plot(
  File &quot;/home/neil/miniconda3/envs/sims/lib/python3.8/site-packages/matplotlib/axes/_axes.py&quot;, line 1665, in plot
    lines = [*self._get_lines(*args, data=data, **kwargs)]
  File &quot;/home/neil/miniconda3/envs/sims/lib/python3.8/site-packages/matplotlib/axes/_base.py&quot;, line 225, in __call__
    yield from self._plot_args(this, kwargs)
  File &quot;/home/neil/miniconda3/envs/sims/lib/python3.8/site-packages/matplotlib/axes/_base.py&quot;, line 391, in _plot_args
    x, y = self._xy_from_xy(x, y)
  File &quot;/home/neil/miniconda3/envs/sims/lib/python3.8/site-packages/matplotlib/axes/_base.py&quot;, line 269, in _xy_from_xy
    raise ValueError(&quot;x and y must have same first dimension, but &quot;


Stacktrace:
  [1] pyerr_check
    @ ~/.julia/packages/PyCall/7a7w0/src/exception.jl:62 [inlined]
  [2] pyerr_check
    @ ~/.julia/packages/PyCall/7a7w0/src/exception.jl:66 [inlined]
  [3] _handle_error(msg::String)
    @ PyCall ~/.julia/packages/PyCall/7a7w0/src/exception.jl:83
  [4] macro expansion
    @ ~/.julia/packages/PyCall/7a7w0/src/exception.jl:97 [inlined]
  [5] #107
    @ ~/.julia/packages/PyCall/7a7w0/src/pyfncall.jl:43 [inlined]
  [6] disable_sigint
    @ ./c.jl:458 [inlined]
  [7] __pycall!
    @ ~/.julia/packages/PyCall/7a7w0/src/pyfncall.jl:42 [inlined]
  [8] _pycall!(ret::PyCall.PyObject, o::PyCall.PyObject, args::Tuple{Vector{Float64}, Vector{ComplexF64}}, nargs::Int64, kw::Ptr{Nothing})
    @ PyCall ~/.julia/packages/PyCall/7a7w0/src/pyfncall.jl:29
  [9] _pycall!(ret::PyCall.PyObject, o::PyCall.PyObject, args::Tuple{Vector{Float64}, Vector{ComplexF64}}, kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})
    @ PyCall ~/.julia/packages/PyCall/7a7w0/src/pyfncall.jl:11
 [10] pycall(::PyCall.PyObject, ::Type{PyCall.PyAny}, ::Vector{Float64}, ::Vararg{Any, N} where N; kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})
    @ PyCall ~/.julia/packages/PyCall/7a7w0/src/pyfncall.jl:83
 [11] pycall(::PyCall.PyObject, ::Type{PyCall.PyAny}, ::Vector{Float64}, ::Vararg{Any, N} where N)
    @ PyCall ~/.julia/packages/PyCall/7a7w0/src/pyfncall.jl:83
 [12] plot(::Vector{Float64}, ::Vararg{Any, N} where N; kws::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})
    @ PyPlot ~/.julia/packages/PyPlot/XaELc/src/PyPlot.jl:177
 [13] plot(::Vector{Float64}, ::Vararg{Any, N} where N)
    @ PyPlot ~/.julia/packages/PyPlot/XaELc/src/PyPlot.jl:174
 [14] top-level scope
    @ In[84]:13
 [15] eval
    @ ./boot.jl:360 [inlined]
 [16] include_string(mapexpr::typeof(REPL.softscope), mod::Module, code::String, filename::String)
    @ Base ./loading.jl:1116
</pre></div>
</div>
</div>
</div>
<p>A brute force way to include shot-to-shot noise on a simulated parameter is to just run the simulation multiple times – with the parameter pulled each time from some probability distribution – and then average the results.</p>
<p>As an example, we consider fluctuations of the laser’s electric field <span class="math notranslate nohighlight">\(E\)</span> such that  <span class="math notranslate nohighlight">\(E \sim \mathcal{N}(\bar{E}, \delta E^2)\)</span>, then we should expect a Gaussian decay profile <span class="math notranslate nohighlight">\(e^{-t^2 / 2\tau^2}\)</span> with: <span class="math notranslate nohighlight">\(1/\tau = \delta E\bigg(\frac{\partial\omega}{\partial E}\bigg)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Move back to using Δm = 0 transition</span><span class="w"></span>
<span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca40</span><span class="p">([(</span><span class="s">&quot;S1/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;D5/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="w"></span>
<span class="n">set_sublevel_alias!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S1/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"></span>
<span class="w">                            </span><span class="s">&quot;D&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;D5/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span><span class="w"></span>

<span class="n">chain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LinearChain</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">ions</span><span class="o">=</span><span class="p">[</span><span class="n">C</span><span class="p">],</span><span class="w"> </span><span class="n">com_frequencies</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mf">1e6</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">vibrational_modes</span><span class="o">=</span><span class="p">(;</span><span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="w"></span>

<span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Trap</span><span class="p">(</span><span class="n">configuration</span><span class="o">=</span><span class="n">chain</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="o">=</span><span class="mf">4e-4</span><span class="p">,</span><span class="w"> </span><span class="n">Bhat</span><span class="o">=</span><span class="n">ẑ</span><span class="p">,</span><span class="w"> </span><span class="n">δB</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">lasers</span><span class="o">=</span><span class="p">[</span><span class="n">L</span><span class="p">]);</span><span class="w"></span>

<span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">vibrational_modes</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="o">.</span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4e-4</span><span class="w"></span>
<span class="n">T</span><span class="o">.</span><span class="n">δB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="c"># recompute the wavelength</span><span class="w"></span>
<span class="n">L</span><span class="o">.</span><span class="n">λ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transitionwavelength</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">);</span><span class="w"></span>

<span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Efield_from_pi_time</span><span class="p">(</span><span class="mf">2e-6</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">))</span><span class="w"></span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">60</span><span class="w"></span>

<span class="c"># average over Ntraj runs</span><span class="w"></span>
<span class="n">Ntraj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="w"></span>
<span class="n">δE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="n">E</span><span class="w"></span>
<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span><span class="w"></span>
<span class="n">ψi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="k">begin</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">Ntraj</span><span class="w"></span>
<span class="w">        </span><span class="n">ΔE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">δE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">randn</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="n">L</span><span class="o">.</span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ΔE</span><span class="w"> </span>
<span class="w">        </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ψi</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">ex</span><span class="w"> </span><span class="o">.+=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"> </span><span class="o">./</span><span class="w"> </span><span class="n">Ntraj</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="c"># compute expected τ</span><span class="w"></span>
<span class="n">hz_per_E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Efield_from_rabi_frequency</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ẑ</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">))</span><span class="w"></span>
<span class="n">τ_us</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e6</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">π</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">δE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hz_per_E</span><span class="p">)</span><span class="w"></span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="nd">@.</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">tspan</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="o">√</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">τ_us</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;C1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ls</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Gaussian Envelope&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="nd">@.</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">tspan</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="o">√</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">τ_us</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;C1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ls</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tspan</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Excitation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>118.506039 seconds (489.48 M allocations: 13.141 GiB, 9.77% gc time, 0.89% compilation time)
</pre></div>
</div>
<img alt="../_images/getting_started_123_1.png" src="../_images/getting_started_123_1.png" />
</div>
</div>
</section>
<section id="adding-more-than-a-single-ion-laser">
<h3>Adding more than a single ion/laser<a class="headerlink" href="#adding-more-than-a-single-ion-laser" title="Permalink to this headline">#</a></h3>
<p>Adding addtional lasers and ions to the system is straightforward. Here we’ll see how that’s done by modeling a Mølmer-Sørensen interaction <span id="id3">[<a class="reference internal" href="#id6" title="Anders Sørensen and Klaus Mølmer. Entanglement and quantum computation with ions in thermal motion. Phys. Rev. A, 62:022311, Jul 2000. URL: https://link.aps.org/doi/10.1103/PhysRevA.62.022311, doi:10.1103/PhysRevA.62.022311.">SorensenMolmer00</a>]</span>, which can be used to entangle the electronic states of multiple ions and requires at least two laser tones and vibrational mode.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Construct the system</span><span class="w"></span>
<span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ca40</span><span class="p">([(</span><span class="s">&quot;S1/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;D5/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="w"></span>
<span class="n">set_sublevel_alias!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S1/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"></span>
<span class="w">                            </span><span class="s">&quot;D&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;D5/2&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span><span class="w"></span>
<span class="n">L1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Laser</span><span class="p">();</span><span class="w"> </span><span class="n">L2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Laser</span><span class="p">()</span><span class="w"> </span>
<span class="n">chain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LinearChain</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">ions</span><span class="o">=</span><span class="p">[</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">],</span><span class="w"> </span><span class="n">com_frequencies</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mf">1e6</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">vibrational_modes</span><span class="o">=</span><span class="p">(;</span><span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Trap</span><span class="p">(</span><span class="n">configuration</span><span class="o">=</span><span class="n">chain</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="o">=</span><span class="mf">4e-4</span><span class="p">,</span><span class="w"> </span><span class="n">Bhat</span><span class="o">=</span><span class="p">(</span><span class="n">x̂</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ẑ</span><span class="p">)</span><span class="o">/√</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">lasers</span><span class="o">=</span><span class="p">[</span><span class="n">L1</span><span class="p">,</span><span class="w"> </span><span class="n">L2</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Set the laser parameters</span><span class="w"></span>
<span class="n">ϵ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">40e3</span><span class="w"></span>
<span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">80</span><span class="w">  </span><span class="c"># corrects for AC stark shift from single-photon coupling to sidebands</span><span class="w"></span>
<span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">vibrational_modes</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="n">L1</span><span class="o">.</span><span class="n">λ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transitionwavelength</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">);</span><span class="w"></span>
<span class="n">L1</span><span class="o">.</span><span class="n">Δ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ϵ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">d</span><span class="w"></span>
<span class="n">L1</span><span class="o">.</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ẑ</span><span class="w"></span>
<span class="n">L1</span><span class="o">.</span><span class="n">ϵ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x̂</span><span class="w"></span>

<span class="n">L2</span><span class="o">.</span><span class="n">λ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transitionwavelength</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">T</span><span class="p">);</span><span class="w"></span>
<span class="n">L2</span><span class="o">.</span><span class="n">Δ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ϵ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d</span><span class="w"></span>
<span class="n">L2</span><span class="o">.</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ẑ</span><span class="w"></span>
<span class="n">L2</span><span class="o">.</span><span class="n">ϵ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x̂</span><span class="w"></span>

<span class="n">mode</span><span class="o">.</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">η</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">get_η</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">L1</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">))</span><span class="w"></span>
<span class="n">Ω1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">√</span><span class="p">(</span><span class="mf">1e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ϵ</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">η</span><span class="w">  </span><span class="c"># This will give a 1kHz MS strength, since coupling goes like (ηΩ)^2/ϵ</span><span class="w"></span>

<span class="n">Efield_from_rabi_frequency!</span><span class="p">(</span><span class="n">Ω1</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">))</span><span class="w"></span>
<span class="n">Efield_from_rabi_frequency!</span><span class="p">(</span><span class="n">Ω1</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">ψi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="s">&quot;S&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w">  </span><span class="c"># initial state</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input tag_remove-output docutils container">
</div>
<p>We can compare this to the analytical result:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">analytical</span><span class="o">.</span><span class="n">two_ion_ms</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">two_ion_ms</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">Ω</span><span class="p">::</span><span class="n">Real</span><span class="p">,</span> <span class="n">ν</span><span class="p">::</span><span class="n">Real</span><span class="p">,</span> <span class="n">δ</span><span class="p">::</span><span class="n">Real</span><span class="p">,</span> <span class="n">η</span><span class="p">::</span><span class="n">Real</span><span class="p">,</span> <span class="n">n̄</span><span class="p">::</span><span class="n">Real</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://doi.org/10.1103/PhysRevA.62.022311">ref</a></p>
<p>Assumes vibrational mode starts in a thermal state with: <span class="math notranslate nohighlight">\(\langle a^\dagger a\rangle = n̄\)</span>
and ions start in doubly ground state. Returns <code class="docutils literal notranslate"><span class="pre">(ρgg,</span> <span class="pre">ρee)</span></code>, the population in the doubly
ground and doubly excited state, respectively. <code class="docutils literal notranslate"><span class="pre">[Ω],</span> <span class="pre">[ν],</span> <span class="pre">[δ]</span> <span class="pre">=</span> <span class="pre">Hz</span></code></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analytical</span><span class="o">.</span><span class="n">two_ion_ms</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-6</span><span class="n">Ω1</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-6</span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-6</span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1e-6</span><span class="n">ϵ</span><span class="p">,</span><span class="w"> </span><span class="n">η</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">SS</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">DD</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">ls</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">ls</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/getting_started_133_0.png" src="../_images/getting_started_133_0.png" />
</div>
</div>
<p>We can also see what happens when the vibrational mode starts out in a thermal state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">mode</span><span class="o">.</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="w"></span>
<span class="n">ρi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">(</span><span class="n">ionstate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">thermalstate</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="c"># thermal state</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">rwa_cutoff</span><span class="o">=</span><span class="mf">5e5</span><span class="p">)</span><span class="w"></span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collect</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mf">0.25</span><span class="o">:</span><span class="mi">1000</span><span class="p">)</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ρi</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>

<span class="n">SS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">DD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">SD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">DS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;S&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">SS</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;SS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">DD</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;DD&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">SD</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;SD&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">DS</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;DS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analytical</span><span class="o">.</span><span class="n">two_ion_ms</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-6</span><span class="n">Ω1</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-6</span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-6</span><span class="n">mode</span><span class="o">.</span><span class="n">ν</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1e-6</span><span class="n">ϵ</span><span class="p">,</span><span class="w"> </span><span class="n">η</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">ls</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">ls</span><span class="o">=</span><span class="s">&quot;--&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 24.451208 seconds (14.97 M allocations: 1.411 GiB, 10.84% gc time, 1.09% compilation time)
</pre></div>
</div>
<img alt="../_images/getting_started_135_1.png" src="../_images/getting_started_135_1.png" />
</div>
</div>
<p>There is some discrepancy because of the Lamb-Dicke approximation made in the analytical solution.</p>
<p>Adding more ions/lasers/modes is done in the same way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">chain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LinearChain</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">ions</span><span class="o">=</span><span class="p">[</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">],</span><span class="w"> </span><span class="n">com_frequencies</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mf">1e6</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">vibrational_modes</span><span class="o">=</span><span class="p">(;</span><span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Trap</span><span class="p">(</span><span class="n">configuration</span><span class="o">=</span><span class="n">chain</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="o">=</span><span class="mf">4e-4</span><span class="p">,</span><span class="w"> </span><span class="n">Bhat</span><span class="o">=</span><span class="p">(</span><span class="n">x̂</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ẑ</span><span class="p">)</span><span class="o">/√</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">lasers</span><span class="o">=</span><span class="p">[</span><span class="n">L1</span><span class="p">,</span><span class="w"> </span><span class="n">L2</span><span class="p">])</span><span class="w"></span>
<span class="n">global_beam!</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">L1</span><span class="p">)</span><span class="w">  </span><span class="c"># set L1 to shine equally on all ions</span><span class="w"></span>
<span class="n">global_beam!</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">L2</span><span class="p">)</span><span class="w">  </span><span class="c"># set L2 to shine equally on all ions</span><span class="w"></span>
<span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">vibrational_modes</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="n">mode</span><span class="o">.</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">η</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">get_η</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">L1</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">))</span><span class="w"></span>
<span class="n">Ω2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">√</span><span class="p">(</span><span class="mf">1e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ϵ</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">η</span><span class="w">  </span>
<span class="n">Efield_from_rabi_frequency!</span><span class="p">(</span><span class="n">Ω2</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">))</span><span class="w"></span>
<span class="n">Efield_from_rabi_frequency!</span><span class="p">(</span><span class="n">Ω2</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;S&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">))</span><span class="w"></span>
<span class="n">ψi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ionstate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">repeat</span><span class="p">([</span><span class="s">&quot;S&quot;</span><span class="p">],</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">...</span><span class="p">)</span><span class="w"> </span><span class="o">⊗</span><span class="w"> </span><span class="n">mode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">rwa_cutoff</span><span class="o">=</span><span class="mf">5e5</span><span class="p">)</span><span class="w"></span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.25</span><span class="o">:</span><span class="mi">2000</span><span class="w"></span>
<span class="nd">@time</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger_dynamic</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">ψi</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">);</span><span class="w"></span>

<span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">repeat</span><span class="p">([</span><span class="s">&quot;S&quot;</span><span class="p">],</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">...</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">ionprojector</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">repeat</span><span class="p">([</span><span class="s">&quot;D&quot;</span><span class="p">],</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">...</span><span class="p">),</span><span class="w"> </span><span class="n">sol</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;SSSSSS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;DDDDDD&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">tout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">tout</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;6 Ion Molmer Sorensen&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time (μs)&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 21.806791 seconds (18.62 M allocations: 1.288 GiB, 5.04% gc time, 2.50% compilation time)
</pre></div>
</div>
<img alt="../_images/getting_started_138_2.png" src="../_images/getting_started_138_2.png" />
</div>
</div>
</section>
</section>
<section id="ionsim-physicalconstants">
<h2>IonSim.PhysicalConstants<a class="headerlink" href="#ionsim-physicalconstants" title="Permalink to this headline">#</a></h2>
<p>You can find some commonly used physical constants in <code class="docutils literal notranslate"><span class="pre">IonSim.PhysicalConstants</span></code>. They support all normal algebraic operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">const</span><span class="w"> </span><span class="n">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IonSim</span><span class="o">.</span><span class="n">PhysicalConstants</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">pc</span><span class="o">.</span><span class="n">ħ</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0545718e-34 [m²kg/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">pc</span><span class="o">.</span><span class="n">c</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.99792458e8 [m/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">μB</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pc</span><span class="o">.</span><span class="n">ħ</span><span class="p">)</span><span class="w"></span>
<span class="n">println</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">ħ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pc</span><span class="o">.</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="n">println</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">α</span><span class="o">^</span><span class="n">pc</span><span class="o">.</span><span class="n">α</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.794100069810324e10
2.99792458e8
0.9647321772836126
</pre></div>
</div>
</div>
</div>
</section>
<section id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">#</a></h2>
<div class="docutils container" id="id4">
<dl class="citation">
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id1">KramerPOR18</a></span></dt>
<dd><p>Sebastian Krämer, David Plankensteiner, Laurin Ostermann, and Helmut Ritsch. Quantumoptics. jl: a julia framework for simulating open quantum systems. <em>Computer Physics Communications</em>, 227:109–116, 2018.</p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id3">SorensenMolmer00</a></span></dt>
<dd><p>Anders Sørensen and Klaus Mølmer. Entanglement and quantum computation with ions in thermal motion. <em>Phys. Rev. A</em>, 62:022311, Jul 2000. URL: <a class="reference external" href="https://link.aps.org/doi/10.1103/PhysRevA.62.022311">https://link.aps.org/doi/10.1103/PhysRevA.62.022311</a>, <a class="reference external" href="https://doi.org/10.1103/PhysRevA.62.022311">doi:10.1103/PhysRevA.62.022311</a>.</p>
</dd>
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id2">WHK+07</a></span></dt>
<dd><p>Chr. Wunderlich, Th. Hannemann, T. Körber, H. Häffner, Ch. Roos, W. Hänsel, R. Blatt, and F. Schmidt-Kaler. Robust state preparation of a single trapped ion by adiabatic passage. <em>Journal of Modern Optics</em>, 54(11):1541–1549, 2007. URL: <a class="reference external" href="https://doi.org/10.1080/09500340600741082">https://doi.org/10.1080/09500340600741082</a>, <a class="reference external" href="https://arxiv.org/abs/https://doi.org/10.1080/09500340600741082">arXiv:https://doi.org/10.1080/09500340600741082</a>, <a class="reference external" href="https://doi.org/10.1080/09500340600741082">doi:10.1080/09500340600741082</a>.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "HaeffnerLab/IonSim.jl-Examples",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.6"
        },
        kernelOptions: {
            kernelName: "julia-1.6",
            path: "./tutorial-notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.6'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Installation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Installation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>